<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-maintenance/tiered-storage/remote-storage" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">Remote Storage | Fluss</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alibaba.github.io/fluss-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://alibaba.github.io/fluss-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://alibaba.github.io/fluss-docs/docs/maintenance/tiered-storage/remote-storage/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Remote Storage | Fluss"><meta data-rh="true" name="description" content="Remote storage usually means a cost efficient and fault-tolerant storage comparing to local disk, such as S3, HDFS, OSS."><meta data-rh="true" property="og:description" content="Remote storage usually means a cost efficient and fault-tolerant storage comparing to local disk, such as S3, HDFS, OSS."><link data-rh="true" rel="icon" href="/fluss-docs/img/logo.svg"><link data-rh="true" rel="canonical" href="https://alibaba.github.io/fluss-docs/docs/maintenance/tiered-storage/remote-storage/"><link data-rh="true" rel="alternate" href="https://alibaba.github.io/fluss-docs/docs/maintenance/tiered-storage/remote-storage/" hreflang="en"><link data-rh="true" rel="alternate" href="https://alibaba.github.io/fluss-docs/docs/maintenance/tiered-storage/remote-storage/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://xx-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/fluss-docs/blog/rss.xml" title="Fluss RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fluss-docs/blog/atom.xml" title="Fluss Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Fluss" href="/fluss-docs/opensearch.xml"><link rel="stylesheet" href="/fluss-docs/assets/css/styles.1072641d.css">
<script src="/fluss-docs/assets/js/runtime~main.e831a68f.js" defer="defer"></script>
<script src="/fluss-docs/assets/js/main.d4281fe9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fluss-docs/"><b class="navbar__title text--truncate">Fluss</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fluss-docs/docs/intro/">Docs</a><a class="navbar__item navbar__link" href="/fluss-docs/blog/">Blog</a><a class="navbar__item navbar__link" href="/fluss-docs/community/">Community</a><a class="navbar__item navbar__link" href="/fluss-docs/roadmap/">Roadmap</a><a class="navbar__item navbar__link" href="/fluss-docs/downloads/">Downloads</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/alibaba/fluss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fluss-docs/docs/intro/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/quickstart/flink/">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/concepts/architecture/">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/install-deploy/overview/">Installation &amp; Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/table-design/overview/">Table Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/engine-flink/getting-started/">Engine Flink</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/streaming-lakehouse/overview/">Streaming Lakehouse</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/fluss-docs/docs/maintenance/configuration/">Maintenance</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/configuration/">Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/fluss-docs/docs/maintenance/filesystems/overview/">File Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/fluss-docs/docs/maintenance/tiered-storage/overview/">Tiered Storage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/tiered-storage/overview/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fluss-docs/docs/maintenance/tiered-storage/remote-storage/">Remote Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/tiered-storage/lakehouse-storage/">Lakehouse Storage</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/metric-reporters/">Metric Reporters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/monitor-metrics/">Monitor Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fluss-docs/docs/maintenance/logging/">Logging</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/fluss-docs/docs/dev/building/">Development Guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fluss-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Maintenance</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tiered Storage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Remote Storage</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Remote Storage</h1></header>
<p>Remote storage usually means a cost efficient and fault-tolerant storage comparing to local disk, such as S3, HDFS, OSS.
See more detail about how to configure remote storage in documentation of <a href="/fluss-docs/docs/maintenance/filesystems/overview/">filesystems</a>.</p>
<p>For log table, Fluss will use remote storage to store the tiered log segments of data. For primary key table, Fluss will use remote storage to store the snapshot as well as the tiered log segments for change log.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote-log">Remote Log<a href="#remote-log" class="hash-link" aria-label="Direct link to Remote Log" title="Direct link to Remote Log">​</a></h2>
<p>As a streaming storage, Fluss data is mostly consumed in a streaming fashion using tail reads. To achieve low
latency for tail reads, Fluss will store recent data in local disk. But for older data, to reduce local disk cost,
Fluss will move data from local to remote storage, such as S3, HDFS or OSS asynchronously.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-configurations-about-remote-log">Cluster configurations about remote log<a href="#cluster-configurations-about-remote-log" class="hash-link" aria-label="Direct link to Cluster configurations about remote log" title="Direct link to Cluster configurations about remote log">​</a></h3>
<p>By default, Fluss will copy local log segments to remote storage in every 1 minute. The interval is controlled by configuration <code>remote.log.task-interval-duration</code>.
If you don&#x27;t want to copy log segments to remote storage, you can set <code>remote.log.task-interval-duration</code> to 0.</p>
<p>Below is the list for all configurations to control the log segments tiered behavior in cluster level:</p>
<table><thead><tr><th>Configuration</th><th>type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>remote.log.task-interval-duration</td><td>Duration</td><td>1min</td><td>Interval at which remote log manager runs the scheduled tasks like copy segments, clean up remote log segments, delete local log segments etc. If the value is set to 0s, it means that the remote log storage is disabled.</td></tr><tr><td>remote.log.index-file-cache-size</td><td>MemorySize</td><td>1gb</td><td>The total size of the space allocated to store index files fetched from remote storage in the local storage.</td></tr><tr><td>remote.log-manager.thread-pool-size</td><td>Integer</td><td>4</td><td>Size of the thread pool used in scheduling tasks to copy segments, fetch remote log indexes and clean up remote log segments.</td></tr><tr><td>remote.log.data-transfer-thread-num</td><td>Integer</td><td>4</td><td>The number of threads the server uses to transfer (download and upload) remote log file can be  data file, index file and remote log metadata file.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="table-configurations-about-remote-log">Table configurations about remote log<a href="#table-configurations-about-remote-log" class="hash-link" aria-label="Direct link to Table configurations about remote log" title="Direct link to Table configurations about remote log">​</a></h3>
<p>When local log segments are copied to remote storage, the local log segments will be deleted to reduce local disk cost.
But some times, we want to keep the several latest log segments retain in local although they has been coped to remote storage for better read performance.
You can control how many log segments to retain in local by setting the configuration <code>table.log.tiered.local-segments</code>(default is 2) per table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote-snapshot-of-primary-key-table">Remote snapshot of primary key table<a href="#remote-snapshot-of-primary-key-table" class="hash-link" aria-label="Direct link to Remote snapshot of primary key table" title="Direct link to Remote snapshot of primary key table">​</a></h2>
<p>In Fluss, one primary key table is distributed to multiple buckets. For each bucket of primary key table, Fluss will only always keep one replica in local disk without any follower replicas.</p>
<p>So, for fault tolerance of local disk fail forever, Fluss will do snapshots to the replicas of primary key table periodically and upload the snapshots to remote storage.
The snapshot will keep a log offset representing the next unread change log while doing the snapshot. Then, when the machine holding the replica fails, Fluss can recover the replica in other live machines by downloading the snapshot from remote storage and apply the change log
since last snapshot.</p>
<p>What&#x27; more, with the snapshot and the consistent log offset, Fluss client can seamlessly switch from full reading phase(reading snapshot) to the incremental
phase (subscribe change log from the consistent log offset) without any data duplication or loss.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-configurations-about-remote-snapshot">Cluster configurations about remote snapshot<a href="#cluster-configurations-about-remote-snapshot" class="hash-link" aria-label="Direct link to Cluster configurations about remote snapshot" title="Direct link to Cluster configurations about remote snapshot">​</a></h3>
<p>Below is the list for all configurations to control the snapshot behavior in cluster level:</p>
<table><thead><tr><th>Configuration</th><th>type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>kv.snapshot.interval</td><td>Duration</td><td>10min</td><td>The interval to perform periodic snapshot for kv data.</td></tr><tr><td>kv.snapshot.scheduler-thread-num</td><td>Integer</td><td>1</td><td>The number of threads that the server uses to schedule snapshot kv data for all the replicas in the server.</td></tr><tr><td>kv.snapshot.transfer-thread-num</td><td>Integer</td><td>4</td><td>The number of threads the server uses to transfer (download and upload) kv snapshot files.</td></tr><tr><td>kv.snapshot.num-retained</td><td>Integer</td><td>1</td><td>The maximum number of completed snapshots to retain. It&#x27;s recommended to set it to a larger value to avoid the case that server delete the snapshot while the client is still reading the snapshot.</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/fluss-docs/docs/maintenance/tiered-storage/overview/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fluss-docs/docs/maintenance/tiered-storage/lakehouse-storage/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lakehouse Storage</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#remote-log" class="table-of-contents__link toc-highlight">Remote Log</a><ul><li><a href="#cluster-configurations-about-remote-log" class="table-of-contents__link toc-highlight">Cluster configurations about remote log</a></li><li><a href="#table-configurations-about-remote-log" class="table-of-contents__link toc-highlight">Table configurations about remote log</a></li></ul></li><li><a href="#remote-snapshot-of-primary-key-table" class="table-of-contents__link toc-highlight">Remote snapshot of primary key table</a><ul><li><a href="#cluster-configurations-about-remote-snapshot" class="table-of-contents__link toc-highlight">Cluster configurations about remote snapshot</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Alibaba, Inc.
      Apache®, Apache Flink®, Flink®, Apache Kafka®, Kafka®, Spark® and associated open source project names and logos are trademarks of the Apache Software Foundation.</div></div></div></footer></div>
</body>
</html>